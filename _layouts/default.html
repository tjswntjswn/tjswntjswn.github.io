<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{page.title | default: site.title}}</title>
    <link rel="stylesheet" href="{{'/css/butter.css' | relative_url}}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <a id="btn-back-to-top" href="#" style="display: none; position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px; background-color: #FBC02D; color: #5D4037; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.3); text-align: center; line-height: 50px; font-size: 24px; font-weight: bold; z-index: 2147483647; border: 2px solid #fff; text-decoration: none;">â†‘</a>
    <script>
        document.addEventListener("DOMContentLoaded", function() {

        // --- 1. ë§¨ ìœ„ë¡œ ê°€ê¸° ê¸°ëŠ¥ ---
        const backToTopBtn = document.getElementById("btn-back-to-top");
        if(backToTopBtn) {
            window.addEventListener("scroll", function() {
                if(window.scrollY > 200) backToTopBtn.style.display = "block";
                else backToTopBtn.style.display = "none";
            });
            backToTopBtn.addEventListener("click", function(e) {
                e.preventDefault();
                window.scrollTo({top: 0, behavior: 'smooth'});
            });
        }

        // --- 2. ëŒ“ê¸€ ê°¯ìˆ˜ ê¸°ëŠ¥ (ê°•ë ¥ ë§¤ì¹­ ëª¨ë“œ) ---
        const repo = "tjswntjswn/tjswntjswn.github.io";

        // "ë¹„êµë¥¼ ìœ„í•´ ê»ë°ê¸° ë‹¤ ë²—ê¸°ëŠ” í•¨ìˆ˜" (ê³µë°±, ìŠ¬ëž˜ì‹œ, íŠ¹ìˆ˜ë¬¸ìž ì œê±°)
        function normalize(text) {
            if(!text) return "";
            return decodeURIComponent(text).replace(/\s+/g, "").replace(/\//g, "").replace(/\.html$/g, "").toLowerCase();
        }

        fetch(`https://api.github.com/repos/${repo}/issues?per_page=100`)
            .then(response => response.json())
            .then(data => {
                const issueMap = {};
                if(Array.isArray(data)) {
                    data.forEach(issue => {
                        const key = normalize(issue.title);
                        issueMap[key] = issue.comments;
                    });
                }

                document.querySelectorAll(".comment-cnt-target").forEach(el => {
                    const urlKey = normalize(el.getAttribute("data-url"));
                    const titleKey = normalize(el.getAttribute("data-title"));
                    let count = 0;

                    
                    if(issueMap[urlKey] !== undefined) { // 1. ì£¼ì†Œ ì•Œë§¹ì´ë¼ë¦¬ ë¹„êµ
                        count = issueMap[urlKey];
                    } else if(issueMap[titleKey] !== undefined) { // 2. ì œëª© ì•Œë§¹ì´ë¼ë¦¬ ë¹„êµ (ì œëª©ìœ¼ë¡œ ì €ìž¥ëì„ ê²½ìš° ëŒ€ë¹„)
                        count = issueMap[titleKey];
                    }

                    // ê²°ê³¼ ì ìš©
                    el.innerHTML = `ðŸ’¬ ${count}`;
                    if (count > 0) el.style.fontWeight = "bold";
                    el.style.opacity = 1;
                });
            })
            .catch(err => console.log("ëŒ“ê¸€ ë¡œë”© ì‹¤íŒ¨:", err));
    });
</script>
    {%include header.html%}
    <div class="container">
        {%include sidebar.html%}
        <main>{{content}}</main>
    </div>
    {%include footer.html%}
</body>
</html>